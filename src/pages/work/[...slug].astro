---
import Article from '@src/layouts/Article.astro';
import Img from '@src/components/Img.astro'
import { getCollection, render } from 'astro:content';

export async function getStaticPaths() {
  const workPages = (await getCollection('items')).filter((item) => (
    item.filePath?.match(/^src\/items\/page\//))
    && item.data.page !== 'none'
  );
  return workPages.filter(entry => !(entry.data.draft)).map(entry => ({
    params: { slug: entry.id }, props: { entry },
  }))
}

const { entry } = Astro.props;
const { Content, remarkPluginFrontmatter } = await render(entry);
---

<Article title={entry.data.title} description={entry.data.description}}>
  {entry.data.page === 'auto' ?
  <Img src={entry.data.mainImage} alt="test"/> :
  <Content />}
</BaseLayout>